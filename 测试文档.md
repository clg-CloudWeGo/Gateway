
# 测试文档

| 变更人    | 变更时间   | 变更内容       | 版本号  |
|--------| ---------- |------------|------|
| 高宇轩    | 2023-07-31 | 完成测试文档基本内容 | v1.0 |
| 刘子恒，曹信 | 2023-07-31 | 修改完善       | v2.0 |
```
# 1.引言

测试文档由软件设计说明所驱动。测试用于验证模块单元实现了模块设计中定义的规格。一个完整的单元测试说明应该包含白盒测试和黑盒测试。测试验证程序应该执行的工作，测试验证程序不应该执行的工作。

## 1.1编写目的

通过测试尽可能的找出项目中的错误，并加以纠正。测试不仅是最后的复审，更是保证软件质量的关键。 简单地说就是想尽一切方法尝试“破坏”它，这样才能找出失败与不足之处，最终的任务就是构造更高质量的软件产品。

## 1.2参考文献

1. IEEE标准
2. 《软件工程与计算(卷二):软件开发的技术基础》刘钦、丁二玉著
3. MSCS软件需求规格文档

# 2.测试平台

Ubuntu20.04

# 3.测试用例


# 4.结论

网关的关键功能已成功实现并能通过测试，能够正常使用
```
## Benchmark性能测试
运行echo_test.go
```shell
cd EchoService
go test -bench=. echo_test.go
```
运行student_test.go
```shell
cd StudentService
go test -bench=. student_test.go
```



## 3.1 StudentService的测试用例

```go


// BenchmarkStudentServiceRegister tests the performance of the StudentService Register function.
func BenchmarkStudentServiceRegister(b *testing.B) {
	for i := 0; i < b.N; i++ {
		student := generateRandomStudent()

		bytesData, err := json.Marshal(student)
		if err != nil {
			b.Fatalf("Error marshalling data: %v", err)
		}

		reader := bytes.NewReader(bytesData)
		request, err := http.NewRequest("POST", aUrlRegister, reader)

		if err != nil {
			b.Fatalf("Error creating request: %v", err)
		}
		defer request.Body.Close()

		request.Header.Set("Content-Type", "application/json;charset=UTF-8")

		client := http.Client{}
		startTime := time.Now()
		resp, err := client.Do(request)
		if err != nil {
			b.Fatalf("Error sending request: %v", err)
		}
		elapsed := time.Since(startTime)

		defer resp.Body.Close()

		var response RegisterResponse
		err = json.NewDecoder(resp.Body).Decode(&response)
		if err != nil {
			b.Fatalf("Error decoding response: %v", err)
		}

		if !response.Success {
			b.Fatalf("Registration failed for student: %+v", student)
		}

		b.Logf("Student registration successful: %+v (Elapsed time: %v)", student, elapsed)
	}
}
```

## 3.2 EchoService的测试用例

```go
/ BenchmarkEchoService tests the performance of the EchoService Echo function.
func BenchmarkEchoService(b *testing.B) {
	for i := 0; i < b.N; i++ {
		// Create a random message for testing
		message := fmt.Sprintf("hello%d, Cloudwego!", rand.Intn(100))

		// Create the request payload
		request := EchoRequest{
			Message: message,
		}

		bytesData, err := json.Marshal(request)
		if err != nil {
			b.Fatalf("Error marshalling data: %v", err)
		}

		reader := bytes.NewReader(bytesData)
		request_2, err := http.NewRequest("POST", aUrlEcho, reader)
		if err != nil {
			b.Fatalf("Error creating request: %v", err)
		}
		defer request_2.Body.Close()

		request_2.Header.Set("Content-Type", "application/json;charset=UTF-8")

		client := http.Client{}
		startTime := time.Now()
		resp, err := client.Do(request_2)
		if err != nil {
			b.Fatalf("Error sending request: %v", err)
		}
		elapsed := time.Since(startTime)

		defer resp.Body.Close()

		var response EchoResponse
		err = json.NewDecoder(resp.Body).Decode(&response)
		if err != nil {
			b.Fatalf("Error decoding response: %v", err)
		}

		if response.Message != message {
			b.Fatalf("Unexpected response: expected %q, got %q", message, response.Message)
		}

		b.Logf("EchoService successful: Request=%q, Response=%q (Elapsed time: %v)", message, response.Message, elapsed)
	}
}

```



| 测试名称  | 测试内容     | 预期结果     | 测试结果 |
| --------- | ------------ | ------------ | -------- |
| main_test | 发送http请求 | 验证返回信息 | 通过     |

